{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2022-41137",
        "assignerOrgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
        "state": "PUBLISHED",
        "assignerShortName": "apache",
        "dateReserved": "2022-09-20T14:55:51.817Z",
        "datePublished": "2024-12-05T10:01:41.692Z",
        "dateUpdated": "2024-12-05T10:03:34.734Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://repo.maven.apache.org/maven2",
                    "defaultStatus": "unaffected",
                    "packageName": "org.apache.hive:hive-exec",
                    "product": "Apache Hive",
                    "vendor": "Apache Software Foundation",
                    "versions": [
                        {
                            "lessThan": "4.0.0",
                            "status": "affected",
                            "version": "4.0.0-alpha-1",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "reporter",
                    "value": "Junjie Liao"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Apache Hive&nbsp;Metastore (HMS) uses&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">SerializationUtilities#deserializeObjectWithTypeInformation</span><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;method when filtering and fetching partitions that is unsafe and</span>&nbsp;can lead&nbsp;to Remote Code Execution (RCE) since it allows the deserialization of arbitrary data.<br><br>In real deployments, the vulnerability can be exploited only by authenticated users/clients that were able to successfully establish&nbsp;a connection to the Metastore. From an API perspective any code that calls the unsafe method may be vulnerable unless it performs additional prerechecks on the input arguments."
                        }
                    ],
                    "value": "Apache Hive Metastore (HMS) uses SerializationUtilities#deserializeObjectWithTypeInformation method when filtering and fetching partitions that is unsafe and can lead to Remote Code Execution (RCE) since it allows the deserialization of arbitrary data.\n\nIn real deployments, the vulnerability can be exploited only by authenticated users/clients that were able to successfully establish a connection to the Metastore. From an API perspective any code that calls the unsafe method may be vulnerable unless it performs additional prerechecks on the input arguments."
                }
            ],
            "metrics": [
                {
                    "other": {
                        "content": {
                            "text": "moderate"
                        },
                        "type": "Textual description of severity"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-502",
                            "description": "CWE-502 Deserialization of Untrusted Data",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
                "shortName": "apache",
                "dateUpdated": "2024-12-05T10:01:41.692Z"
            },
            "references": [
                {
                    "tags": [
                        "product"
                    ],
                    "url": "https://github.com/apache/hive"
                },
                {
                    "tags": [
                        "issue-tracking"
                    ],
                    "url": "https://issues.apache.org/jira/browse/HIVE-26539"
                },
                {
                    "tags": [
                        "patch"
                    ],
                    "url": "https://github.com/apache/hive/commit/60027bb9c91a93affcfebd9068f064bc1f2a74c9"
                },
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://lists.apache.org/thread/jwtr3d9yovf2wo0qlxvkhoxnwxxyzgts"
                }
            ],
            "source": {
                "defect": [
                    "HIVE-26539"
                ],
                "discovery": "UNKNOWN"
            },
            "title": "Apache Hive: Deserialization of untrusted data when fetching partitions from the Metastore",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        },
        "adp": [
            {
                "title": "CVE Program Container",
                "references": [
                    {
                        "url": "http://www.openwall.com/lists/oss-security/2024/12/04/2"
                    }
                ],
                "providerMetadata": {
                    "orgId": "af854a3a-2127-422b-91ae-364da2661108",
                    "shortName": "CVE",
                    "dateUpdated": "2024-12-05T10:03:34.734Z"
                }
            }
        ]
    }
}